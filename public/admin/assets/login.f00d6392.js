import{_ as e,d as a,ac as s,r,H as t,af as l,a as o,c as n,b as d,n as i,f as u,g as m,t as p,ag as c,k as g,o as f,l as y,u as v,m as _,p as w,i as h}from"./index.acb399dd.js";import{h as b,g as k}from"./http.6ec28aab.js";const x={class:"login"},V={class:"card"},T=(e=>(w("data-v-74809d76"),e=e(),h(),e))((()=>d("span",{class:"spanTEXT"},"登陆",-1)));var I=e(a({__name:"login",setup(e){const a=s();localStorage.getItem("lzy_token")&&a.replace("/");const w=r(""),h=r(!1),I=r(),S=t({username:"",password:"",email:"",code:""}),j=t({username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:16,message:"账号长度应该是6到16",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"密码长度应该是6到16",trigger:"blur"}]}),z=l((async e=>{try{if(w.value="",h.value=!0,setTimeout((()=>{h.value=!1}),2e3),!e)return;e.validate((async(e,s)=>{if(e){const e=await b("post","/privateApis/login",S);setTimeout((()=>{if(0===e.error||200===e.code){c(),localStorage.setItem("lzy_token",e.data);const s=g().add(7,"day"),r=s.diff(g(),"day");document.cookie=`token_remderDay=${r};expires=${s};path=/`;k().then((e=>{localStorage.setItem("nowWeatherData",JSON.stringify(e)),a.push("/")}))}else w.value="账号或密码错误"}),2e3)}}))}catch(s){}}),1e3);return(e,a)=>{const s=o("el-input"),r=o("el-form-item"),t=o("lzyicon"),l=o("el-button"),c=o("el-form");return f(),n("div",x,[d("div",V,[d("div",{class:i(["item center",{loadBtn:h.value}])},[u(c,{ref_key:"ruleFormRef",ref:I,model:S,rules:j,class:"demo-ruleForm","status-icon":""},{default:m((()=>[u(r,{prop:"username"},{default:m((()=>[u(s,{onKeydown:a[0]||(a[0]=y((e=>v(z)(I.value)),["enter"])),class:"input",modelValue:S.username,"onUpdate:modelValue":a[1]||(a[1]=e=>S.username=e)},{prepend:m((()=>[_("账号")])),_:1},8,["modelValue"])])),_:1}),u(r,{prop:"password"},{default:m((()=>[u(s,{onKeydown:a[2]||(a[2]=y((e=>v(z)(I.value)),["enter"])),class:"input",type:"password",modelValue:S.password,"onUpdate:modelValue":a[3]||(a[3]=e=>S.password=e),"show-password":""},{prepend:m((()=>[_("密码")])),_:1},8,["modelValue"])])),_:1}),u(r,{style:{margin:"0"}},{default:m((()=>[u(l,{type:"primary",style:{"margin-top":"10px"},onClick:a[4]||(a[4]=e=>v(z)(I.value))},{default:m((()=>[u(t,{name:"majesticons:scan-fingerprint-line",style:{"margin-right":"5px"}}),T])),_:1})])),_:1})])),_:1},8,["model","rules"])],2),d("p",{class:i(["pwdTips",{error:w.value.length}])},p(w.value),3)])])}}}),[["__scopeId","data-v-74809d76"]]);export{I as default};
